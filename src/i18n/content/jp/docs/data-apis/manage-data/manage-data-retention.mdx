---
title: データ保持期間の管理
metaDescription: 'Data retention: How long different types of New Relic data are stored.'
translationType: machine
---

**Data retention** ページを使用して、データが New Relic データベース (NRDB) に保存される期間を確認、管理します。機密情報を保護するためにデータを短期間保存したり、長期的な傾向を知るために長期間保存したりすることができます。保存しているデータのソース、最終更新日、データの保存期間を一目で把握することができます。保存期間の設定は、New Relic におけるデータの `ソース` と `名前空間` の分類に応じて、8 日から 395 日の範囲で設定できます。

![データ保持ページのスクリーンショット](./images/edit_retention_settings.png "リテンションズページの編集")

<figcaption>
  データのソースが表示されているData retentionページから、Edit settingsをクリックすると、各ソースのデータ保持量を調整することができます。
</figcaption>

<Callout variant="important">
  この文書は、 [New Relic One の価格モデル](/docs/accounts/accounts-billing/new-relic-one-pricing-users/pricing-billing) の組織に適用されます。オリジナルの製品ベースの価格モデルをご利用の場合、データ保持のルールが異なります。 [Original data retention](/docs/accounts/original-accounts-billing/product-based-pricing/overview-data-retention-components) をご覧ください。どのプランを利用しているかわからない場合は [価格とユーザーモデルの概要](/docs/transition-guide-our-new-pricing-plan-user-model) をご覧ください。
</Callout>

## 保存期間 [#adjust-retention]

以下の表は、 [New Relic One の価格モデル](/docs/accounts/accounts-billing/new-relic-one-pricing-users/pricing-billing) のデフォルトの保持設定を示しています。リテンション設定を調整するには、 [Pro または Enterprise](https://newrelic.com/pricing) の階層にいる必要があります。

<table>
  <thead>
    <tr>
      <th style={{ width: "250px" }}>
        ソース
      </th>

      <th>
        イベントの名前空間
      </th>

      <th>
        保有日数
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        APM
      </td>

      <td>
        APM
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        APM
      </td>

      <td>
        APMのエラー
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        ブラウザ
      </td>

      <td>
        ブラウザ
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        ブラウザ
      </td>

      <td>
        ブラウザイベント
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        ブラウザ
      </td>

      <td>
        ブラウザのJSエラー
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        ブラウザ
      </td>

      <td>
        ブラウザのページビュータイミング
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        カスタムイベント
      </td>

      <td>
        カスタムイベント
      </td>

      <td>
        30
      </td>
    </tr>

    <tr>
      <td>
        サーバーレス
      </td>

      <td>
        ラムダ
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        サーバーレス
      </td>

      <td>
        ラムダカスタム
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        サーバーレス
      </td>

      <td>
        ラムダのスパン
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        ログ
      </td>

      <td>
        ログ
      </td>

      <td>
        30
      </td>
    </tr>

    <tr>
      <td>
        インフラストラクチャ
      </td>

      <td>
        インフラストラクチャー・プロセス
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        インフラストラクチャ
      </td>

      <td>
        Infrastructureインテグレーション
      </td>

      <td>
        395 (13ヶ月)
      </td>
    </tr>

    <tr>
      <td>
        モバイル
      </td>

      <td>
        モバイルの衝突イベントの軌跡（パンくず式）
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        モバイル
      </td>

      <td>
        モバイルの例外
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        モバイル
      </td>

      <td>
        モバイル総合
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        モバイル
      </td>

      <td>
        モバイルエラー
      </td>

      <td>
        8
      </td>
    </tr>

    <tr>
      <td>
        モバイル
      </td>

      <td>
        モバイルクラッシュ
      </td>

      <td>
        90
      </td>
    </tr>

    <tr>
      <td>
        モバイル
      </td>

      <td>
        モバイルセッション
      </td>

      <td>
        90
      </td>
    </tr>

    <tr>
      <td>
        シンセティック
      </td>

      <td>
        シンセティック・データ
      </td>

      <td>
        395 (13ヶ月)
      </td>
    </tr>

    <tr>
      <td>
        トレース
      </td>

      <td>
        トレース
      </td>

      <td>
        8
      </td>
    </tr>
  </tbody>
</table>

## リテンション値の調整 [#adjust-retention]

お客様は、データのニーズに合わせて保存期間を調整することができます。たとえば、クエリのパフォーマンスを最適化するために、契約上の保持期間を短くすることができます。逆に、データタイプによっては保持期間を長くして、長期間にわたるより詳細な分析をサポートしたり、データのコンプライアンス要件を満たしたりすることもできます。

データ保持期間を編集する機能には、特定の [版の New Relic](https://newrelic.com/pricing) が必要です。

* オリジナル価格モデルのユーザーは、Insights Proが必要です。

* New Relic Oneの価格モデルのユーザーには、以下のようなエディションの考慮点があります。

  * スタンダード版：お客様のデータ保持量は固定されており、使用しているNew Relicプラットフォームのどの機能を使用しているかによって、8日から395日（約13ヶ月）の保持量に該当します。規定の保持レベルにより、お客様がデータを探索し、New Relic の価値を体験できるようになっています。お客様の特定のビジネスニーズのために保持限度の一部を引き上げる必要がある場合は、追加の保持を購入することができます。
  * ProまたはEnterprise：契約上の保持を確定した後、変更する必要があると気付いた場合は、遠隔測定データの保持設定を自分で調整することができます。

### ユーザーの役割と保持

リテンションを編集するためには、ユーザーはこれらのロールが必要です。

* [New Relic One のユーザーモデル](/docs/accounts/accounts-billing/new-relic-one-user-management/new-relic-one-user-model-understand-user-structure): the [**Billing user** role](/docs/accounts/accounts-billing/new-relic-one-user-management/new-relic-one-user-model-understand-user-structure/#standard-roles)
* [オリジナルユーザーモデルのユーザー](/docs/accounts/original-accounts-billing/original-users-roles/users-roles-original-user-model): オーナーまたは [**データ保持管理者** アドオンロール](/docs/accounts/original-accounts-billing/original-users-roles/users-roles-original-user-model/#add-on)

### リテンション値の低下

特定のデータソースの保持日数を短縮しても、そのソースタイプの既存データはすぐには消えません。そのデータは数週間は表示され、クエリで返される可能性があります。誤ってデータを削除してしまわないようにセーフガードを設けていますが、このことは、保持日数を減らすことが、データを素早く [削除するための良い戦略ではないことを意味しています](#data-deletion) 。

とはいえ、お客様の変更は12時間以内にシステムに登録され、調整されたソースタイプの新しいデータは新しい期間保持されます。

契約した保持値よりもデータ保持量を減らしても、New Relic のデータ取り込み料金は減らないことに注意してください。逆に、対象となる遠隔測定データタイプの保持量を増やすと、データ取り込み料金の調整についてNew Relicとの会話が発生する可能性があります。

## コピー・リテンション・バリュー

保持設定を編集する権限がある場合は、ある子アカウントの保持値を、同じ親アカウントの下にある他の子アカウントにコピーすることもできます。これを行うには、子アカウント内で **Copy settings to other accounts** リンクを選択し、保持値を適用したい子アカウントを選択します。

![に保持値をコピーする子アカウントのイメージ](./images/copy-data-retention.png "コピー・リテンション・バリュー")

<figcaption>
  リテンション値をコピーする子アカウントを選択します。
</figcaption>

## データの削除

[テレメトリーデータ](/docs/using-new-relic/data/understand-data/new-relic-data-types) (イベント、メトリクス、ログ、トレース) が New Relic に報告され、問い合わせが可能になると、そのデータを編集したり削除したりすることはできません。これは、New Relic のスピードとパフォーマンスを最適化するための意図的な設計上の決定です。データは、その [データ保持期間](#adjust-retention) が終了すると失効します。データを削除する必要がある場合は、New Relic の担当者にお問い合わせください。

## APIによるリテンション管理 [#api-examples]

保持の設定は、UIだけでなく、 [NerdGraph](/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/) で変更することができます。以下の例では、必要な情報を提供し、 [NerdGraph GraphiQL explorer](https://api.newrelic.com/graphiql) でコードを実行してください。

お客様の保持の変更は、更新後24時間以内に有効になります。

<CollapserGroup>
  <Collapser
    id="api-list-namespaces"
    title="カスタマイズ可能なリテンションイベントの名前空間の一覧"
  >
    アカウントのカスタマイズ可能なリテンションイベント名スペースを一覧表示する。

    ```
    query {
     actor {
       account(id: <var>YOUR_ACCOUNT_ID</var>) {
         dataManagement {
           customizableRetention {
             eventNamespaces {
               namespace
             }
           }
         }
       }
     }
    }
    ```
  </Collapser>

  <Collapser
    id="api-list-rules"
    title="アカウントのアクティブなルールのリスト"
  >
    アカウントのアクティブなルールを一覧表示するには

    ```
    query {
     actor {
       account(id: <var>YOUR_ACCOUNT_ID</var>) {
         dataManagement {
           eventRetentionRules {
             id
             deletedAt
             deletedById
             createdAt
             createdById
             retentionInDays
             namespace
           }
         }
       }
     }
    }
    ```
  </Collapser>

  <Collapser
    id="api-show-active-rule"
    title="アカウント/名前空間ペアのアクティブなルールを表示する"
  >
    特定のアカウント/ネームスペースのペアに対するアクティブなルールを表示するには、次のようにします。

    ```
    query {
     actor {
       account(id: <var>YOUR_ACCOUNT_ID</var>) {
         dataManagement {
           eventRetentionRule(namespace: "APM") {
             id
             deletedById
             deletedAt
             createdById
             createdAt
             retentionInDays
             namespace
           }
         }
       }
     }
    }
    ```
  </Collapser>

  <Collapser
    id="api-create-new-rule"
    title="新規ルールの作成"
  >
    新しいルールを作成するには

    ```
    mutation {
     dataManagementCreateEventRetentionRule(accountId: <var>YOUR_ACCOUNT_ID</var>, namespace: "APM", retentionInDays: 8) {
       id
       deletedById
       deletedAt
       createdById
       createdAt
       retentionInDays
       namespace
     }
    }
    ```
  </Collapser>

  <Collapser
    id="api-delete-rule"
    title="既存のルールの削除"
  >
    子アカウントに適用されているルールを削除した場合、その子アカウントは、指定されたネームスペースに対して親アカウントの現在の保持値を採用します。親アカウントに適用されているルールを削除した場合、指定されたネームスペースにデフォルトの保持値が再適用されます。既存のルールを削除するには、以下の手順に従います。

    ```
    mutation {
     dataManagementDeleteEventRetentionRule(accountId: <var>YOUR_ACCOUNT_ID</var>, namespace: "APM") {
       id
       deletedById
       deletedAt
       createdById
       createdAt
       retentionInDays
       namespace
     }
    }
    ```
  </Collapser>

  <Collapser
    id="api-delete-rule"
    title="既存の子アカウントのルールを他の人にコピー"
  >
    テンプレートまたはソースアカウントとして子アカウントを指定し、他の宛先子アカウントにソース子アカウントの同じ名前空間保持値を採用させることができます。注意: すべての子アカウントは、同じ親アカウント内になければなりません。既存の保持のセットをコピーするには

    ```
    mutation {
      dataManagementCopyRetentions(
        sourceAccountId: <var>SOURCE_ACCOUNT_ID</var>,
        destinationAccountIds: [<var>DESTINATION_ACCOUNT_ID_1</var>, <var>DESTINATION_ACCOUNT_ID_2</var>, <var>DESTINATION_ACCOUNT_ID_3</var>])
      {
        success
        failure
      }
    }
    ```

    成功と失敗は、ソースアカウントからのルールのコピーに成功（または失敗）したデスティネーションアカウントIDのリストを返します。
  </Collapser>
</CollapserGroup>

## メトリクスデータのロールアップ

[メトリックのタイムスライスデータ](/docs/using-new-relic/data/understand-data/new-relic-data-types#timeslice-data) は、APM（カスタムメトリクスとデフォルトメトリクスの両方）、モバイル、およびブラウザエージェントによって生成されます。メトリックのタイムスライスは、メトリック名、メトリックが表す時間のセグメント（"タイムスライス" ）、および数値（測定値）の3つの部分から構成されます。APM、ブラウザ、モバイルエージェントは、エラーレート、帯域幅の使用量、ガベージコレクションの時間など、さまざまなパフォーマンス指標について、1分間に数千個のメトリックタイムスライスを収集することができます。

メートル単位のタイムスライスデータは、このように集計されます。

* 8日間保存される1分間のロールアップへの最初の
* 1分間のロールアップは、90日間保持される1時間のロールアップにも追加されます。

キーメトリックデータは無期限に保存されます。最初の1分間のロールアップのサイズを計測し、その後のロールアップは計測しません。製品別の主要な測定値については、こちらをご覧ください。

### APM、ブラウザ、モバイルで報告されるキーメトリクス

ここでは、無期限に保存される主要なメトリクスを紹介します。

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        **製品**
      </th>

      <th>
        **主要指標**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        APM
      </td>

      <td>
        * [Apdex](/docs/site/apdex-measuring-user-satisfaction), アプリサーバー用
        * スループットとページビュー
        * レスポンスタイムとその内訳 [階層別](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#tier) またはカテゴリー別に [あなたのアプリのメイン **概要** チャート](/docs/apm/applications-menu/monitoring/apm-overview-page)
        * ページのロード時間、および [のセグメントに分けた内訳。](/docs/browser/new-relic-browser/page-load-timing-resources/page-load-timing-process#time-segments)
        * エラー率
        * CPU使用率
        * メモリ使用量
      </td>
    </tr>

    <tr>
      <td>
        ブラウザ
      </td>

      <td>
        * [Apdex](/docs/site/apdex-measuring-user-satisfaction), ブラウザ用
        * ブラウザのページロード時間
        * スループットの合計。90日以降は、ブラウザタイプ別の集計は行われず、要求された時間範囲の合計平均値のみが表示されます。
      </td>
    </tr>

    <tr>
      <td>
        モバイル
      </td>

      <td>
        * クラッシュレートです。 [iOSの場合](/docs/mobile-monitoring/new-relic-mobile/getting-started/ios-agent-crash-reporting) 、 [Androidの場合](/docs/mobile-monitoring/new-relic-mobile/getting-started/android-agent-crash-reporting)
        * [ネットワークスループット](/docs/mobile-monitoring/mobile-monitoring-ui/network-pages/http-requests-page)
        * [ネットワーク応答時間](/docs/mobile-monitoring/mobile-monitoring-ui/network-pages/http-requests-page)
        * [ネットワークエラー率](/docs/mobile-monitoring/mobile-monitoring-ui/network-pages/errors-mobile-apps)
        * [インタラクション・トレース](/docs/mobile-monitoring/mobile-monitoring-ui/mobile-app-pages/interactions-page)
      </td>
    </tr>
  </tbody>
</table>

### 生のメトリックデータ

生のメトリックデータは、APM、Prometheus のリモートライト API、Telemetry SDK のメトリック機能、Telemetry SDK 上に構築されたインテグレーションから送られてくる場合は、扱いが少し異なります。生のサブミニッツメトリックデータは30日間保存されます。30日以降は、1分分解能のロールアップイベントが作成され、13ヶ月間保持されます。メトリック・タイムスライス・データの場合と同様に、後続のロールアップではなく、生のインジェストのサイズで計測・請求を行います。

メトリクスの保存期間は編集できません。

## アカウントの継承 [#account-structure]

[親アカウント](/docs/accounts/original-accounts-billing/original-users-roles/mastersub-account-structure) のデータ保持設定は、その子アカウントに継承されます。ここでは、組織の最初のアカウントが親アカウントとして扱われ、組織に追加された他のアカウントはそのアカウントの設定を継承します。また、これらの設定を上書きして、アカウント固有のデータ保持設定を行うオプションもあります。

## オリジナルの価格設定モデルの違い [#original-pricing]

当社のオリジナル製品ベースの価格モデルをご利用の場合、データ保持のルールが異なります。 [オリジナルのデータ保持](/docs/accounts/original-accounts-billing/product-based-pricing/overview-data-retention-components) をご参照ください。